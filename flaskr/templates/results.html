<!doctype html>
<html>
<title>Results page</title>
<link rel=stylesheet type=text/css href="{{ url_for('static' , filename= 'styles.css') }}">
  <body>
    <div class=page>
      <h1>RESULTS</h1>
      <h2>here is your results page</h2>
      <h3>below information about how popular each of the catagories and interests you entered are as well as on the right information anyone has left encyrpted only for people with your shared interest</h3>
      <button class="collapsible">More information</button>
      <div class="content">
        <p>This website will compare your entered interests anonymously with the servers database. Then if you choose data can be recorded to add and you can see messages others have left encrypted just for those with your interest. All data is securely held</p>
      </div>

      <div class ="row">
        <div class="column" style = "width: 50%;"> <h3>Interests</h3> 
          <ol>
            <form method = "POST">
              {% for a in range(0, len)%}
                <li>{{"favorite " + (catagories[a])|string + " is " + (interests[a])|string }}</li>
                
                <p>&#9; {{peoplelist[a]}} other people have your interest, this was the {{ popularitylist[a][0]}} most popular response out of {{popularitylist[a][1]}} interests within this catagory</p>
                <input type="checkbox" id={{ "insert" + a|string }} name={{ "interest" + (a+1)|string }} value="check" onclick="dynInput(this); ">
                <label for = {{ "insert" + a|string }}>add to interst {{a + 1}} ? </label>
                <div id={{"insertinputsinterest" + a|string }} ></div>
                <br>
              {%endfor%}
              <br>
              
              <br>
              <input type = "submit" name = "submitentries" value = "submitentries" id = "results button">
            </form>
          </ol>    
      
    
        </div>
        <div class="column" style = "width:50%;">
          <h2>Extra information</h2>
          {% for a in range(0, len)%}
            <div class="box">
              {{extraa[a]}}
            </div>
          {%endfor%}
        </div>

      </div>

      
      
      </div>
    <br>
    <br>
    
    <h2>originality</h2>
    <div class="progress" >
      <div class="status" id = "progressslider" >
        <h2 id="innerStatus">Loading...</h2>
      </div>
    </div>
    <br>
    <br>
    <form method = "POST">
      <input type = "submit" name = "return" value = "return" id = "return button">
    </form>

    <script>
      var coll = document.getElementsByClassName("collapsible");
      var k;
      //make event listener for each
      for (k = 0; k < coll.length; k++) {
        coll[i].addEventListener("click", function() {
        
        this.classList.toggle("active");
        var content = this.nextElementSibling;
        if (content.style.maxHeight){
          content.style.maxHeight = null;
        } else {
          //autosizing but 5 buffer, could make this equal for the two but predefintion probably then needed or whole dynamic system
          content.style.maxHeight = content.scrollHeight + 5 + "px";
        } 
        
        });
      }
      var i = 0;

     
      async function getStatus() {
        
        let get;
        //try to get information from json
        try {
          const res = await fetch("/results/status");
          get = await res.json();
        } catch (e) {
          console.error("Error: ", e);
        }

        i = 1;
        var id = setInterval(frame, 10);
        //element update
        var statusbar = get.status;
        document.getElementById("innerStatus").innerHTML = 1 * 1 + "&percnt;";

        widthmax = statusbar * 1;
        document.getElementById("progressslider").style.width = 1 + "%";
        width = 1;
        //$(".status").css({width: "100%",color: "blue"});
        //max status
        var id = setInterval(frame,15)
        function frame(){
          if(width < widthmax){
            width++;
            document.getElementById("progressslider").style.width = width + "%";
            document.getElementById("innerStatus").innerHTML = width * 1 + "&percnt;";

          }else{
            clearInterval(id);
          }
        }
        if (get.status == 100){
          
          clearTimeout(timeout);
          return false;
        }

        //timeout = setTimeout(getStatus, 1000);
      }
      //document.getElementById("progressslider").style.width = 100 * 1 + "%;";
      getStatus()

      function dynInput(cbox) {
        if (cbox.checked) {
          var input = document.createElement("textarea");
          input.type = "text";
          input.id = cbox.name + "t";
          input.name = cbox.name + "t";
          var div = document.createElement("div");
          div.id = cbox.name + "d";
          div.innerHTML = "Text to display for " + cbox.name;
          div.appendChild(input);
          document.getElementById("insertinputs" + cbox.name).appendChild(div);
        } else {
          document.getElementById(cbox.name + "d").remove();
        }
      }

      //<textarea name = "textareaa1"></textarea>
      /*function dynInput(cbox) {
        if (cbox.checked) {
          var input = document.createElement("input");
          input.type = "text";
          input.name = cbox.name + "t";
          var div = document.createElement("div");
          input.id = cbox.name + "t";
          div.innerHTML = "input information for" + cbox.name;
          div.appendChild(input);
          document.getElementById("insertinputs").appendChild(div);
        } else {
          document.getElementById(cbox.name + "t").remove();
        }
      }*/
    
    </script>
  </body>
</html>